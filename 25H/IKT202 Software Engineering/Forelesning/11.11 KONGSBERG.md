Modellbasert Software Arkitektur
Joint Strike Missile

# Intro til JSM
FPGA https://en.wikipedia.org/wiki/Field-programmable_gate_array


Computer 
- Høy kompleksistet. Tar lang tid å utvikle. 
- Felles forståelse
- mer enn 1 million linjer kode
- Hvor mange software-komponenter
	- Over 300 komponenter
	70-80 utviklere.

#### Hvordan håndtere kompleksiteten.
- Dele opp i subsystemer som kan utvikles av egne team. (10-12 initielle)
- Utvikle systemet inkrementelt. 
	- Første inkrement var kun separasjon fra fly og sveveflukt uten jetmotor.
	- De neste inkluderte motor og andre funksjoner.
- Modellere systemet
	- Mekanisk (CAD)
	- Funksjonell modell behaviour
	- Systemarkitekturmodell (logisk og fysisk)
	- Softwarearkitekturmodell med kodegenerering.

# Hva er software-arkitektur
- strukturerer
- subsytemer
- funksjoner
- komponenter
- lagdeling
- prosesser
- moduler
- koblinger
- pakker
- deployment
Viktige begreper
- Systemer
	- Missilet, toppnivået. Avhenger av konteksten, Sammenhengende deler som jobber sammen mot et felles mål eller funksjon. Har en definiert grense mot andre systemer.
+ Subsystemer
	+ Et system som er del av en større system. Et subsystem vil ikke tilby fullverdig funksjon uten å bli integrert med andre susbsystemer
+ Komponenter
	+ En del som inngår i et system/subsystem
	+ Tilbyr en  eller flere funksjoner i susbystemet.
	+ Ofte ikke fullverdig funksjon uten å bli integrert.
	+ Software FPGA, elektronikk mekanikk.
# Arkitekturmodellen
+ En representasjon av et objekt, prosess, system
+ Fysiske eller abstrakte.
+ Modell vs tegning
	+ Elementene i modellen er relatert til hverandre etter gitte regler.
	+ Tegning er uformell, f.eks powerpoint.
	+ Modell kan sjekkers for feil.
	+ Modellen kan benyttes som utgangspunkt for generering av dokumenter og kode
+ Views (synsvinkel)
	+ For å beskrive et komplekst system har man behov for å se fra ulike vinkler.
	+ Sette den sammen for et mer komplett modell.

+ UML 
	+ Standardisert modell for design av software
+ SYSML
	+ Standardisert modell for design av systemer

### Modellrammeverk
+ mange måter å strukturere en modell på
+ Hvilke diagrammer
+ hvilke pakker, mapper

+ UAF (Unified architecture frameework?
+ Standardisert rammeverk for systems of systems design
+ MagicGrid (used by omg), starting to become official standard
	+ Design of system standard


### Modell eksempel med MagicGrid og UAF
Magic grid: Domain, Requirements, Structure, behaviour , parameters
vertically domains. Problem domain and solution domain, implementation domain (config)

logisk arkitektur er funksjonell struktur, fysisk forskjellige deler.

**Funksjoner i systemet**
+ Planning og decision making (autonomous part)
+ Flight
+ Perception and Sensing

Problem domain:
Context Model.
Requirements (stakeholder needs)
	Functional Requirements. 
	Trace it to stake holder needs with use cases
Use Cases
+ Operational 
	+ Activity diagram, what functions a use case consists of
		Need to plan, navigate there, avoid obstacles. Help from external system, situational awareness.
+ maintenance use cases
+ Parameters column, Parameter models to model up weight, performance, and everything.


Functional Architecture
	How the three main function works together. Ports and integrations. 
		Regulerings loop (reguleringsteknikk)
		Flight control, steering and propulsion (actuators), localization state). strcture, 

SystemDesign hvordan finner vi riktige subsystemer
	Dele opp etter fyssiske hoveddeler
	Dele opp etter hovedfunksjoner
- Vi valgte å basere subsystemene på en funksjonell oppdeling fordiØ 
	- Software for en funksjon kan være spredt på flere fysiske kort
	- Fordel å samle all kunskap om en funksjon på et team.

Planning and decision -> mission control system
flight -> flight system
perception and sensing -> perception system

Solution domain:
Logical architecture
Hierarchical view, connectivity view. 
Software interface between systems defined in uml.

Mission Control System is a subsytem in missile system.
Same with flight and perception.
Flightsystem is further divided.
into flightcontrol system. propullsion system, airframesystem (structure). Navigation system. 

navigation = IMU, inertual measurement. GPS receiver. 

Sekvensdiagrammer
- Beskrive hvoredan komponenteer eller subsystemer kommuniserer for å realisere en funksjon iCo systemet.
- Sekvensdiagrammene kobles til scenarier i kravspesifikasjonen.

Abstraksjoner
	Hvorfor bruker vi dette og hva kan dette representere i software-arkitektur'
	Bruk gjerne til å skjule detaljer
	Problem og løsningsdomene.
	Concrete physical components are found in the implementation domain in consfigurations.
	Abstraksjoner på fumksjoner data hardware ekstern systemer

Design prinsipper
	S.O.L.I.D [[SOLID]]
		Single responsibility
		Open closed
		Liskov substitution principle
			Bytte ut en realisering av et system eller komponent med et annet alternativt system
			Interface mot navigasjonsystem er abstract, sier bare hva den skal levere.
		Interface  segregation
			Holde tjenester adskilte fra interface slik at. Ikke mikse masse tjenester i samme punkt
		Dependency Inversion Principle
			Ønsker ikke at komponentene skal "vite om hverandre", en kontekst setter dem sammen. Navigator vet at den kan ta imot gps data, hvordan er det konteksten som bestemmer.

Vedlikehold av modell
	Hvorfor er det viktig å holde modellen oppdatert
	En utdatarert modell er vanskelig å stole på og vil etter hvert ikke bli brukt.
	Software arktitekturen generes fra modellen
		Grensesnitt
		Koblinger mellom systemer og komponenter
		Deployment.
			Skal noe endres skal det endres i modellen først.

# Kode eksempler
Missile Computer
	Egenutviklet
	Basert på 2stk PowerPC CPU med 8-kjerner
	Hovedkortet er selvlaget med spesielle krav til temperaturområde vibrasjon, fuktighet og størrelse/form.
	Laste software inn på maskinenen er en helt egen prosess.
	Operativsystemet er Green Hills INTEGRITY (f35). RTOS
	Real time krav, - kritisike funsksjoner, styring av sstyrefinner, må ha presis timing og frekvens.
	Ikke real time funksjoner. Replanlegging av oppdrag. Kan kjøre separat uten å forstyrre styringssystemet.

Segmentering av prosessorer
- Flere noder (virtuelle maskiner med egne os installasjoner)
  + gir isolasjon mellom kritiske og mindre kritisike funksjoner.
  + Styring dedikerte kjerner med høy pri på tasker
  + planleggingØ flere kjerner, men må dele med andre
Programmeringspråk
	Må støtte real-time -> C++
	Ikke språk med garbage collection java c# etc.
Distribuert applikasjon
+ Fra utsiden ser det ut som en applikasjon
+ Består av flere prosesser på ulike CPU-er
+ kommuniserer via middleware (seamless<)
+ 

Distribuert system
+ Webapplikaasjon
	+ Frontend
	+ Backend
+ Normalt sett kan ikk gjøre funksjonkall på et annet
	+ REST Api
+ Missilet bruker en egenutviklet mekanisme.
+ Komponentene kan snakkes sammen, selv om det er ulike prosesser.
+ Dette kalles mellomvare eller middleware
	+ Komponentene kan kommunisere uten å vite hvor de andre kjører
	+ utviklerne kan dermed fokusere på algoritmene, ikke på nettverkslogikk eller prosessplassering

Deployment
+ Logivcal
	+ Interfaces
	+ Functions
	+ Connections
+ Deployment
	+ Real time performance
	+ Distribution
	+ Can switch out with a stub since its an abstract component, and the stub can implement the interface.

Utviklingsmiljø
+ 
# Oppsummering