>[!definition] Population
>All data $\implies$ divide by $N$

>[!definition] Utvalg
>Part of data $\implies$ divide by $N-1$

## R 2D dataset
```R
Book1 <- read_excel("fil.xlsx")
plot(x=Book1$Høyde,y=Book1$Vekt, xlim=c(150,200), cex=0.5, pch=16,col="#123456")

```
`xlim` limits x values, input is a 2-vector, denoted by `c(x1,x2)`. `cex`: character expansion (scaling text), `pch`: point type. `col`: colour. 


```R
a <- 80
b <- -0.1
yhat <-  a+b*x # forutsagt verdi
abline(a=a, b=b, col="maroon")
```

![[image.png]]
```R
segments(x0=x,y0=y, x1=x, y1=yhat)
```
For all (x,y) pairs, draw a line from the y, to the line yhat.

![[image-1.png]]

```R
a <- -60
b <- 0.8
```
We can tweak a,b to get better fit.
![[image-3.png]]
Lets instead find a,b, and minimise total quadratic distance.

#### Linear Regression
We can do this in R
```R
linMod <- lm(y ~ x)
plot(x=Book1$Hoyde, y=Book1$Vekt, xlim(c(150,200),cex=0.5.,pch=16))
abline(linMod, col="maroon")
linSum <- summary(linMod)
```

| ![[image-4.png]] | ![[image-5.png]] |
| ---------------- | ---------------- |

To extract coefficients from linMod we do
```R
a <- linMod$Coefficients[1]
b <- linMod$Coefficients[1]
yhat <- a+b*x
segments(x0=x, y0=y, x1=x, y1=yhat, col="orange")
```
### With edited data
```R
HV <- read_excel("HV-main.xlsx")
x <- HV$Høyde
y <- HV$Vekt
plot(x=x, y=y, xlim=c(150,200),cex=0.5,pch=16,rgb(...))
linMod <- lm(y ~ x)
linMod <- (Vekt ~ Høyde, data=HV) # same
abline(linmod,col="maroon")
a <- linmod$coefficients[1]
b <- linmod$coefficients[2]
yhat <- a+b*x 
segments(x0=x,y0=y, x1=x, y1=yhat)
```
![[image-6.png]]
> [!definition] R-Squared
> R-Squared measures the proportion of variance in the dependent variable explained by the independent variable(s) in a regression model.
> $R^2=1-\frac{\Sigma(y_{i}-\hat{y_{i}})^2}{\Sigma(y_{i}-\bar{y})^{2}}$
> $y_{i}$, is the observed value, $\hat{y_{i}}$ predicted value, and $\bar{y}$ mean of observations. Values range from 0 (no explanation) to 1 (perfect fit), negative values can occur in bad models.

Summary gives R-squared: 0.3175...

## Residuals
```R
# Normal Q-Q Plot
dy <- y -yhat
plot(x=x,y=dy,xlim=c(150,200),cex=0.5,pch=16,col=rgb(0,0.5,0.6))
abline(h=0,col="maroon")
n <- length(x)
segments(x0=x,y0=y, x1=x, y1=yhat)
# linSum residuals
linSum$Residuals
hist(dy,breaks=20)

# SSe calcullation, sum of squared errors
SSe = sum(dy^2)
se2 = SSe/(n-2) # estimates variance, divide by (n-2), prevents underestimating true error variance
se = sqrt(se2) # sigma: tilsvarer standardavvik

# se == linSum$Sigma
```

![[image-8.png]]