>[!definition] Population
>All data $\implies$ divide by $N$

>[!definition] Utvalg
>Part of data $\implies$ divide by $N-1$

## R 2D dataset
```R
Book1 <- read_excel("fil.xlsx")
plot(x=Book1$Høyde,y=Book1$Vekt, xlim=c(150,200), cex=0.5, pch=16,col="#123456")

```
`xlim` limits x values, input is a 2-vector, denoted by `c(x1,x2)`. `cex`: character expansion (scaling text), `pch`: point type. `col`: colour. 

### Guessing regression line
```R
a <- 80
b <- -0.1
yhat <-  a+b*x # forutsagt verdi
abline(a=a, b=b, col="maroon")
```
![[image.png|552x349]]
#### Difference between regression line and actual observation
```R
segments(x0=x,y0=y, x1=x, y1=yhat)
```
For all (x,y) pairs, draw a line from the y, to the line $\hat{y}$.

![[image-1.png|552x328]]

```R
a <- -60
b <- 0.8
```
We can tweak a,b to get better fit.
![[image-3.png|552x359]]
Lets instead find a,b, and minimise total quadratic distance.

#### Linear Regression
We can do this in R
```R
linMod <- lm(y ~ x)
plot(x=Book1$Hoyde, y=Book1$Vekt, xlim(c(150,200),cex=0.5.,pch=16))
abline(linMod, col="maroon")
linSum <- summary(linMod)
```

| ![[image-4.png]] | ![[image-5.png]] |
| ---------------- | ---------------- |

To extract coefficients from linMod we do
```R
a <- linMod$Coefficients[1]
b <- linMod$Coefficients[1]
yhat <- a+b*x
segments(x0=x, y0=y, x1=x, y1=yhat, col="orange")
```
### With edited data
```R
HV <- read_excel("HV-main.xlsx")
x <- HV$Høyde
y <- HV$Vekt
plot(x=x, y=y, xlim=c(150,200),cex=0.5,pch=16,rgb(...))
linMod <- lm(y ~ x)
linMod <- (Vekt ~ Høyde, data=HV) # same
abline(linmod,col="maroon")
a <- linmod$coefficients[1]
b <- linmod$coefficients[2]
yhat <- a+b*x 
segments(x0=x,y0=y, x1=x, y1=yhat)
```
![[image-6.png|552x378]]
## R-Squared
> [!definition] R-Squared
> R-Squared measures the proportion of variance in the dependent variable explained by the independent variable(s) in a regression model.
> $R^2=1-\frac{\Sigma(y_{i}-\hat{y_{i}})^2}{\Sigma(y_{i}-\bar{y})^{2}}$
> $y_{i}$, is the observed value, $\hat{y_{i}}$ predicted value, and $\bar{y}$ mean of observations. Values range from 0 (no explanation) to 1 (perfect fit), negative values can occur in bad models.

Summary gives R-squared: 0.3175...

## Residuals
```R
# Normal Q-Q Plot
dy <- y -yhat
plot(x=x,y=dy,xlim=c(150,200),cex=0.5,pch=16,col=rgb(0,0.5,0.6))
abline(h=0,col="maroon")
n <- length(x)
segments(x0=x,y0=y, x1=x, y1=yhat)
# linSum residuals
linSum$Residuals
hist(dy,breaks=20)

# SSe calcullation, sum of squared errors
SSe = sum(dy^2)
se2 = SSe/(n-2) # estimates variance, divide by (n-2), prevents underestimating true error variance
se = sqrt(se2) # sigma: tilsvarer standardavvik

# se == linSum$Sigma
```


![[image-8.png|552x572]]

## Scatterplots
```R
library(alr4)
library(car)
library(MASS)
head(mtcars)
scatterplot(x=mtcars$mpg, y=mtcars$wt)) # ligger i car
```
![[image-9.png|552x345]]
## ScatterplotMatrix
`scatterplotMatrix(mtcars)`
gives a matrix

![[image-10.png]]

#### Limit the matrix
`scatterplotMatrix(mtcars[4:7]`
![[image-11.png|552x524]]
#### Specify columns
`scatterplotMatrix([c(1,5,11)])`

![[image-12.png|552x553]]
#### Specify column names
```R
myCars <- mtcars[(c("mpg", "hp", "wt"))]
scatterplotMatrix(myCars)
```
![[image-13.png|552x462]]
#### Transform the hp variable by taking the inverse
```R
# Transform hp-variable (x-variable)
mod_1 <- lm(mpg ~ I(1/hp), data=myCars)) # I(create a new column that is the inverse)
# mpg = a + b/hp
plot(x=myCars$hp,y=myCars$mpg,pch=14,col="blue")
```
![[image-14.png|552x408]]
#### Draw the correlating line
```R
a <- mod_1$coefficients[1]
b <- mod_1$coefficients[2]
xLine <- seq(50, 340, 0.07)
yLine <- a + b/xLine
lines(xLine,yLine,col="maroon")
```
![[image-15.png|552x390]]
#### Transform mpg variable instead
```R
# transform mpg-variable (y-variable)
mod_2 <- lm(I(1/mpg) ~ hp, data=myCars)) # I(create a new column that is the inverse)
# 1/mpg = gpm = a = b*hp


a2 <- mod_1$coefficients[1]
b2 <- mod_1$coefficients[2]
plot(x=myCars$hp,y=myCars$mpg,pch=14,col="blue")

xLine2 <- seq(50, 340, 0.07)
yLine2 <- 1/(a2 + b2*xLine2)
lines(xLine2,yLine2,col="maroon")
```
![[image-16.png|552x427]]

### Which is better?
Multiple R-squared says $73\%$ of the variation in $y$ can be explained by $x$$...$

| summary(mod_2)<br> | summary(mod_1)    |
| ------------------ | ----------------- |
| ![[image-17.png]]  | ![[image-18.png]] |
|                    |                   |
### Another variable
We can do 1/x or 1/y. Now lets try with another variable
```R
scatterplot(myCars["mpg"],myCars["wt"])

```


# Project
Moduler -> Forprosjektmal etc.
1. Gjøre målinger. Mange målinger. Finne ut noe basert på målinger ( hvis det er significant. 
2. 